<!DOCTYPE html>
<html lang="en-us">
<head>
<meta charset="utf-8">
<meta name="description" content="">
<meta name="keywords" content="">
<meta name="author" content="Guowei Lv">
<meta name="generator" content="Hugo 0.25.1" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="http://lvguowei.me/css/style.css" type="text/css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700" type="text/css">
<link rel="alternate" href="http://lvguowei.me/index.xml" type="application/rss+xml" title="Guowei Lv">
<title>Mock Objects Demystified - Guowei Lv</title>
</head>
<body>

<header>
  <div class="container clearfix">
    <a class="path" href="http://lvguowei.me/">[Guowei Lv]</a>
    <span class="caret"># _</span>
    <div class="right">
      
    </div>
  </div>
</header>

<div class="container">


<main role="main" class="article">
  
<article class="single" itemscope itemtype="http://schema.org/BlogPosting">
  <div class="meta">

    <span class="key">published on</span>
    <span class="val"><time itemprop="datePublished" datetime="2017-03-20">March 20, 2017</time></span>


    <span class="key">in</span>
    <span class="val">

        <a href="http://lvguowei.me/categories/programming">programming</a>

    </span>


    <br>
    <span class="key">tags:</span>
    <span class="val">

        <a href="http://lvguowei.me/tags/tdd">TDD</a>

    </span>

  </div>
  <h1 class="headline" itemprop="headline">Mock Objects Demystified</h1>
  <section class="body" itemprop="articleBody">
    <p>If you have ever tried writing any non trivial tests, mocks should not be a stranger to you. But what about some other &ldquo;mock&rdquo; like objects like stubs, spies and such? How are they different from each other? In this blog post, I will explain it as simple and easy to remember as possible.</p>

<p>Everything is a <strong>test double</strong>. <strong>Test double</strong> is just a general name for all mock like objects.</p>


<figure >
    
        <img src="http://lvguowei.me/img/test-double.jpeg" />
    
    
</figure>


<p>Then the simplest of them all is <strong>Dummy</strong>. A <strong>Dummy</strong> is an implementation of an interface that all methods return as close to nothing as possible. It don&rsquo;t do nothing, it don&rsquo;t return nothing, it&rsquo;s just there.</p>

<p>We often use an dummy when we test a function and it requires some argument that is not related to what we want to test.</p>


<figure >
    
        <img src="http://lvguowei.me/img/dummy.jpeg" />
    
    
</figure>


<p>Next in the sequence of test doubles is <strong>stub</strong>, <strong>stub</strong> is a dummy, all functions in stub do nothing. The difference is that instead of return nothing, the functions return some predefined fixed value.</p>

<p>By return certain values, the stub drives the code to the path way that we want to test.</p>


<figure >
    
        <img src="http://lvguowei.me/img/stub.jpeg" />
    
    
</figure>


<p>The next test double is the <strong>spy</strong>. The spy is a stub, it do nothing and return the value that are useful to the test. However, it remember certain interesting facts about the way it is called, and report the facts later to the test.</p>

<p>Sometimes you write a spy just to remember a function gets called, or how many times it gets called, or how many args are passed in, etc. But, a spy don&rsquo;t do nothing, all the spy does is watch and remember.</p>


<figure >
    
        <img src="http://lvguowei.me/img/spy.jpeg" />
    
    
</figure>


<p>At last, the <strong>mock</strong>. A mock is a spy, but it knows very specific how to check what are being spied. Usually it contains some <em>verify&hellip;()</em> function like <em>verifyAlertTriggerOnThirdFailedAttempt()</em>. So a true mock is a spy knows what to expect, and the test ask the mock if everything went as expected.</p>


<figure >
    
        <img src="http://lvguowei.me/img/mock.jpeg" />
    
    
</figure>


<p>Finally there is the <strong>fake</strong>. A fake is not anything above. It is a simulator. The fake is very smart and complicated and it starts to look like the real deal. For example, a fake <code>Authorizer</code> may return <code>User</code> with id 1 if you pass in names that start with <code>good</code>, else it returns <code>InvalidUser</code>. But be caucious not to grow it too much or it will become a mess very quickly. And you probably want to have tests that test fakes. For unit tests fakes are really not that necessary, but for intergration tests, they can come quite handy. But in general, avoid fakes when you can.</p>


<figure >
    
        <img src="http://lvguowei.me/img/fake.jpeg" />
    
    
</figure>


<p>That&rsquo;s the end.</p>

  </section>

  <br/>

  <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "lvguoweime" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</article>

</main>


</div>
<footer>
  <div class="container">
    <span class="copyright">&copy; 2017  Guowei Lv</span>
  </div>
</footer>

</body>
</html>

